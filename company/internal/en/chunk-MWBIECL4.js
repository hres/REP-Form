import{$a as j,Aa as ce,Ab as z,Ba as me,Bb as Q,C as I,Ca as pe,Cb as Oe,D as ie,Da as de,Db as je,Ea as ue,F as i,Fa as he,G as u,Ga as ve,Ha as fe,I as C,Ia as _e,L as c,La as k,M as re,N as s,Na as ye,O as o,Oa as Ee,P as M,Pa as P,Q as Y,Qa as Ce,R as J,Ra as ge,S as w,T as h,Ta as Se,U as y,Ua as Ie,V as b,Va as N,W as F,Wa as Z,X as L,Xa as O,Y as a,Ya as be,Z as v,Za as Fe,_ as f,ba as ne,c as ee,ca as R,da as p,e as S,ea as d,fa as oe,fb as U,gb as Le,ha as K,ib as xe,jb as Te,kb as Me,n as te,na as A,oa as V,ob as we,p as B,pb as Be,rb as Re,s as x,sb as Ae,t as T,tb as q,ub as Ve,vb as H,wb as ke,xa as se,xb as Pe,ya as ae,yb as X,za as le,zb as Ne}from"./chunk-64A7ADBD.js";function ze(l,E){l&1&&(Y(0),s(1,"p"),a(2,'First time users of this form cannot select a file to load and must create an XML file by completing all the required fields below and clicking the "Save draft XML" button at the bottom of this form. '),o(),s(3,"p"),a(4,"For subsequent uses of this form, upload "),s(5,"u"),a(6,"the last final xml file"),o(),a(7,", you received from Health Canada, by clicking on the \u201CChoose file\u201D button and selecting the xml file. If you do not have the final xml file, contact client information unit at "),s(8,"a",3),a(9,"client.information@hc-sc.gc.ca"),o(),a(10,"."),o(),s(11,"p"),a(12,'If you partially complete the form and click on the "Save working copy" button at the bottom of the form, it will save a copy on the local workstation for completion at later time. The file will be saved in the .hcsc file format. The working copies (files with extension .hcsc) should never be sent Health Canada and must be finalized prior to sending.'),o(),J())}function Qe(l,E){l&1&&(Y(0),s(1,"p"),a(2,"Les nouveaux utilisateurs de ce formulaire ne peuvent pas s\xE9lectionner un fichier \xE0 charger et doivent cr\xE9er un fichier XML en remplissant tous les champs obligatoires ci-dessous et en cliquant sur le bouton \xAB Enregistrer le brouillon XML \xBB au bas de ce formulaire."),o(),s(3,"p"),a(4,"Pour les utilisations subs\xE9quentes de ce formulaire, t\xE9l\xE9chargez "),s(5,"u"),a(6,"le dernier fichier xml final"),o(),a(7," que vous avez re\xE7u de Sant\xE9 Canada, en cliquant sur le bouton \xAB Choisir un fichier \xBB et en s\xE9lectionnant le fichier xml. Si vous ne disposez pas du fichier xml final, contactez l'unit\xE9 d'information client \xE0 "),s(8,"a",3),a(9,"client.information@hc-sc.gc.ca"),o(),a(10,"."),o(),s(11,"p"),a(12,"Si vous remplissez partiellement le formulaire et cliquez sur le bouton \xAB Enregistrer la copie de travail \xBB au bas du formulaire, il enregistrera une copie sur le poste de travail local pour qu'elle soit compl\xE9t\xE9e ult\xE9rieurement. Le fichier sera enregistr\xE9 au format de fichier \xAB .hcsc \xBB. Les copies de travail (fichiers avec extension .hcsc) ne doivent jamais \xEAtre envoy\xE9es \xE0 Sant\xE9 Canada et doivent \xEAtre finalis\xE9es avant l'envoi."),o(),J())}var Ue=(()=>{class l{static{this.\u0275fac=function(r){return new(r||l)}}static{this.\u0275cmp=B({type:l,selectors:[["app-filereader-instruction"]],inputs:{lang:"lang"},standalone:!0,features:[R],decls:4,vars:2,consts:[[1,"row"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],[4,"ngIf"],["href","mailto:client.information@hc-sc.gc.ca"]],template:function(r,e){r&1&&(s(0,"div",0)(1,"div",1),C(2,ze,13,0,"ng-container",2)(3,Qe,13,0,"ng-container",2),o()()),r&2&&(i(2),c("ngIf",e.lang==="en"),i(),c("ngIf",e.lang==="fr"))},dependencies:[V,A],encapsulation:2})}}return l})();function $e(l,E){l&1&&(s(0,"div",29)(1,"p"),a(2),p(3,"translate"),o()()),l&2&&(i(2),v(d(3,1,"amend.alert")))}function De(l,E){if(l&1&&(M(0,"control-messages",36),p(1,"formControl")),l&2){let t=y(2);c("showError",t.showErrors)("control",d(1,2,t.coForm.controls.certifyPrivacy))}}function Ge(l,E){if(l&1){let t=w();s(0,"div",30)(1,"div",31)(2,"label",32)(3,"input",33),h("blur",function(){x(t);let e=y();return T(e.processErrors())}),o(),s(4,"strong"),a(5),p(6,"translate"),o(),s(7,"strong",34),a(8),p(9,"translate"),o(),C(10,De,2,4,"control-messages",35),o()()()}if(l&2){let t=y();i(3),c("formControlName","certifyPrivacy"),i(2),f(" ",d(6,4,"consent.privacy"),""),i(3),v(d(9,6,"commmon.required.bracket")),i(2),c("ngIf",t.coForm.controls.certifyPrivacy.invalid)}}function We(l,E){if(l&1){let t=w();s(0,"div",26)(1,"button",37),h("click",function(){x(t);let e=y();return T(e.saveXmlFile())}),a(2),p(3,"translate"),o()()}l&2&&(i(2),f(" ",d(3,1,"generate.final")," "))}function Ye(l,E){if(l&1){let t=w();s(0,"div",26)(1,"button",37),h("click",function(){x(t);let e=y();return T(e.saveXmlFile())}),a(2),p(3,"translate"),o()()}l&2&&(i(2),f(" ",d(3,1,"draft.xml")," "))}function Je(l,E){if(l&1){let t=w();s(0,"div",26)(1,"a",38),h("click",function(){x(t);let e=y();return T(e.mailto())}),a(2),p(3,"translate"),o()()}if(l&2){let t=y();i(),re("disabled",t.disableMailto),c("href",t.mailToLink,I),i(),f(" ",d(3,4,"mailto.label")," ")}}function Ke(l,E){if(l&1&&(s(0,"div",30),M(1,"app-mailto-help",39),o()),l&2){let t=y();i(),c("email",t.submitToEmail)("subject",t.submitToSubject)("lang",t.lang)}}var kt=(()=>{class l{constructor(t,r,e,n,m,g,_,$,D,G,W){this._fb=t,this.cdr=r,this._baseService=e,this._globalService=n,this._utilsService=m,this.fileServices=g,this._versionService=_,this._checkSumService=$,this._companyContactService=D,this._companyAddressService=G,this._translateService=W,this._companyEnrolmentErrors=[],this._contactListErrors=[],this._contactCompanyRoleErrors=[],this._addressListErrors=[],this._addressCompanyRoleErrors=[],this._productLineErrors=[],this._consentPrivacyError=[],this.errorList=[],this.headingLevel="h2",this.rootTagText=U,this.versionTagPath=Le,this.startCheckSumVersionNum=5,this.mailToLabel="mailto.label",this.disableMailto=!1,this.showMailToHelpText=!1,this.mailToLink="",this.submitToEmail="",this.submitToSubject="",this._signalService=te(Ae),this.selectedContactCompanyRoles=this._signalService.getSelectedContactCompanyRoles(),this.selectedAddressCompanyRoles=this._signalService.getSelectedAddressCompanyRoles(),this.showErrors=!1,K(()=>{this.processAddressCompanyRolesErrors()}),K(()=>{this.processContactCompanyRolesErrors()})}ngOnInit(){this.coForm||(this.coForm=this._baseService.getReactiveModel(this._fb));try{this._globalService.enrollment?this.enrollModel=this._globalService.enrollment:(this.enrollModel=this._baseService.getEmptyEnrol(),this._globalService.enrollment=this.enrollModel),this.companyEnrolModel=this.enrollModel[this.rootTagText],this._initModels(this.companyEnrolModel),this.lang=this._globalService.currLanguage,this.helpIndex=this._globalService.helpIndex,this.devEnv=this._globalService.devEnv,this.byPassCheckSum=this._globalService.byPassChecksum,this.isInternal=this._globalService.isInternal}catch(t){console.error(t)}}ngAfterViewInit(){document.location.href="#def-top",this.msgList.changes.subscribe(t=>{let r=[];this._updateErrorList(t),this.processErrors()}),this.msgList.notifyOnChanges()}_updateErrorList(t){let r=[];t&&t.forEach(e=>{e.label==="label.consent.privacy"&&r.push(e)}),this._consentPrivacyError=r}processErrors(){this.errorList=[].concat(this._companyEnrolmentErrors,this._addressCompanyRoleErrors,this._addressListErrors,this._contactCompanyRoleErrors,this._contactListErrors,this._productLineErrors,this._consentPrivacyError),this.disableMailto=this.errorList.length>0||this.isInternal,this.showMailToHelpText=!1,this.cdr.detectChanges()}processCompanyEnrolmentErrors(t){this._companyEnrolmentErrors=t,this.processErrors()}processProductLineErrors(t){this._productLineErrors=t,this.processErrors()}processContactListErrors(t){this._contactListErrors=t,this.processErrors()}processAddressListErrors(t){this._addressListErrors=t,this.processErrors()}processContactCompanyRolesErrors(){let t=[];this.isRolesMissing(this.selectedContactCompanyRoles())&&t.push(this._companyContactService.makeMissingRoleError()),this._contactCompanyRoleErrors=t,this.processErrors()}processAddressCompanyRolesErrors(){let t=[];this.isRolesMissing(this.selectedAddressCompanyRoles())&&t.push(this._companyAddressService.makeMissingRoleError()),this._addressCompanyRoleErrors=t,this.processErrors()}isRolesMissing(t){let r=this._globalService.companyRolesList.map(n=>n.id),e=t.map(n=>n.replace(/^\d+/,""));return r.some(n=>!e.includes(n))}hideErrorSummary(){return this.showErrors&&this.errorList&&this.errorList.length>0}saveXmlFile(){this.showErrors=!0,this.processErrors(),this._saveXML()}saveWorkingCopyFile(){let t=this._prepareForSaving(!1),r=this._generateFileName(t[U]);this.fileServices.saveJsonToFile(t,r,null)}processFile(t){t.data!==null&&(this.companyEnrolModel=t.data.COMPANY_ENROL,this._initModels(this.companyEnrolModel),this.isStatusFinal=this.companyEnrolModel.application_type._id==we.FINAL)}_initModels(t){let r=t.address_record;this.addressListModel=Array.isArray(r)?r:[r],this._utilsService.isEmpty(r)&&(this.addressListModel=[]);let e=t.contact_record;this.contactListModel=Array.isArray(e)?e:[e],this._utilsService.isEmpty(e)&&(this.contactListModel=[])}unloadNotification(t){t.returnValue=!0}_saveXML(){if(this.errorList&&this.errorList.length<1){let t=this._prepareForSaving(!0),r=this._generateFileName(t[U]),e=this._versionService.getApplicationMajorVersionWithUnderscore(this._globalService.appVersion),n=Me.toUpperCase()+"_CO_"+e+".xsl";this.fileServices.saveXmlToFile(t,r,!0,n);return}document.location.href="#topErrorSummaryId"}_prepareForSaving(t){let r=null,e=null,n=this._baseService.getEmptyCompanyEnrol();n.date_saved=this._utilsService.getFormattedDate("yyyy-MM-dd-hhmm"),n.software_version=this._globalService.appVersion,n.form_language=this._globalService.currLanguage;let m=this.companyEnrolmentComponent.getFormValue(),g=this.productLineComponent.getFormValue();this.companyAddressListComponent.recordFormArray&&(e=this.companyAddressListComponent.recordFormArray.value),this.companyContactListComponent.recordFormArray&&(r=this.companyContactListComponent.recordFormArray.value),this._baseService.mapCompanyEnrolmentToOutput(n,m,this.isInternal,t),this._baseService.mapProductLineToOutput(n,g),this._baseService.mapContactsFormToOutput(n,r),this._baseService.mapAddressesFormToOutput(n,e),this.outputModel=n;let _={COMPANY_ENROL:n};return t&&(_.COMPANY_ENROL[Z]="",_.COMPANY_ENROL[Z]=this._checkSumService.createHash(_)),console.log("_prepareForSaving ~ output",JSON.stringify(_,null,2)),_}_generateFileName(t){let r=t.company_id,e=t.enrolment_version.replace(/\./g,"-"),n=this.isInternal?Te:xe;return r?`${n}-${r}-${e}`:`${n}-${e}`}mailto(){return ee(this,null,function*(){this.showMailToHelpText=!0;let t="",r="",n=this.companyEnrolmentComponent.getFormValue().companyId,m=null;this.companyAddressListComponent.recordFormArray&&(m=this.companyAddressListComponent.recordFormArray.value);let g=this._findCompanyNameMFRrole(m);this.submitToSubject=yield S(this._translateService.get("email.subject")),this.submitToEmail=yield S(this._translateService.get("email.to"));let _=yield S(this._translateService.get("email.draft")),$=yield S(this._translateService.get("email.company.id"));r=yield S(this._translateService.get("email.body")),t=`${_}${g?g+" ":""}${n||$}`;let D=this.submitToEmail.replace(/[()]/g,"").trim(),G=encodeURIComponent(t),W=encodeURIComponent(r);this.mailToLink=`mailto:${D}?subject=${G}&body=${W}`})}onChanged(t,r){t?.target?.checked===!1&&this.coForm.controls[r].reset()}_findCompanyNameMFRrole(t){let r=t.find(e=>e.addressInfo.selectedAddressCompanyRoles.includes(Be.MFR));return r?r.addressInfo.companyName:null}isEarlyVersion(){return this._versionService.getMajorVersion(this.companyEnrolModel.software_version)<5}static{this.\u0275fac=function(r){return new(r||l)(u(fe),u(oe),u(Q),u(Re),u(P),u(N),u(j),u(O),u(Pe),u(Ve),u(se))}}static{this.\u0275cmp=B({type:l,selectors:[["app-form-base"]],viewQuery:function(r,e){if(r&1&&(b(q,5),b(X,5),b(H,5),b(z,5),b(k,5)),r&2){let n;F(n=L())&&(e.companyEnrolmentComponent=n.first),F(n=L())&&(e.companyContactListComponent=n.first),F(n=L())&&(e.companyAddressListComponent=n.first),F(n=L())&&(e.productLineComponent=n.first),F(n=L())&&(e.msgList=n)}},hostBindings:function(r,e){r&1&&h("beforeunload",function(m){return e.unloadNotification(m)},!1,ie)},standalone:!0,features:[ne([N,P,j,O,Ie,Se,Q]),R],decls:78,vars:71,consts:[[1,"container-fluid","wb-frmvld","wb-init","wb-frmvld-inited"],["name","coForm","novalidate","",3,"formGroup"],[1,"row","mrgn-tp-md"],[1,"col-md-12"],[1,"text-right"],["id","securityInfo",1,"fa","fa-shield","fa-sm"],[1,"panel","panel-primary","mrgn-tp-lg"],[1,"panel-heading","clearfix"],[1,"panel-title"],[3,"id"],[1,"fn-lnk","mrgn-tp-md",3,"href"],[1,"wb-inv"],[1,"panel-body"],[3,"complete","rootTag","lang","versionTagPath","startCheckSumVersion","byPassCheckSum","devEnv"],["fileUploadInstruction","",3,"lang"],["class","col-lg-12 col-md-12 col-sm-12 col-xs-12 alert alert-info",4,"ngIf"],["id","topErrorSummaryId"],["headingPreamble","errorSummary.form.name",3,"hiddenSummary","errorList","headingLevel"],[3,"errorList","showErrors","dataModel","isInternal"],[1,"panel","panel-default"],[1,"fn-lnk",3,"href"],[3,"errorEmit","recordList","showErrors","isInternal","earlyVersion"],[3,"errorEmit","recordList","showErrors","isInternal"],[3,"errorList","showErrors","dataModel"],["class","row",4,"ngIf"],[1,"row","btn-group-sm"],[1,"form-group","col-md-4"],["type","button",1,"btn","btn-default","btn-lg","active",3,"click"],["class","form-group col-md-4",4,"ngIf"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12","alert","alert-info"],[1,"row"],[1,"col-lg-12","col-md-12","col-sm-12","col-xs-12"],["for","certifyPrivacy",1,"required"],["type","checkbox","id","certifyPrivacy","required","",3,"blur","formControlName"],[1,"required"],["parentId","coForm","controlId","certifyPrivacy","label","label.consent.privacy",3,"showError","control",4,"ngIf"],["parentId","coForm","controlId","certifyPrivacy","label","label.consent.privacy",3,"showError","control"],["type","button",1,"btn","btn-primary","btn-lg","active",3,"click"],[1,"btn","btn-primary","btn-lg","active",3,"click","href"],[3,"email","subject","lang"]],template:function(r,e){r&1&&(s(0,"div",0)(1,"form",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5)(6,"strong"),a(7),p(8,"translate"),o()()()()(),s(9,"div")(10,"section",6)(11,"header",7)(12,"h2",8),a(13),p(14,"translate"),s(15,"sup",9)(16,"a",10)(17,"span",11),a(18),p(19,"translate"),o(),a(20),o()()()(),s(21,"div",12)(22,"lib-file-reader",13),h("complete",function(m){return e.processFile(m)}),M(23,"app-filereader-instruction",14),o(),C(24,$e,4,3,"div",15),o()()(),s(25,"div",16),M(26,"lib-error-summary",17),o(),s(27,"div")(28,"section",6)(29,"header",7)(30,"h2",8),a(31),p(32,"translate"),s(33,"sup",9)(34,"a",10)(35,"span",11),a(36),p(37,"translate"),o(),a(38),o()()()(),s(39,"div",12)(40,"app-company-enrolment",18),h("errorList",function(m){return e.processCompanyEnrolmentErrors(m)}),o(),s(41,"section",19)(42,"header",7)(43,"h3",8),a(44),p(45,"translate"),s(46,"sup",9)(47,"a",20)(48,"span",11),a(49),p(50,"translate"),o(),a(51),o()()()(),s(52,"div",12)(53,"app-company-address-list",21),h("errorEmit",function(m){return e.processAddressListErrors(m)}),o()()(),s(54,"section",19)(55,"header",7)(56,"h3",8),a(57),p(58,"translate"),s(59,"sup",9)(60,"a",20)(61,"span",11),a(62),p(63,"translate"),o(),a(64),o()()()(),s(65,"div",12)(66,"app-company-contact-list",22),h("errorEmit",function(m){return e.processContactListErrors(m)}),o()()(),s(67,"app-product-line",23),h("errorList",function(m){return e.processProductLineErrors(m)}),o()()()(),C(68,Ge,11,8,"div",24),s(69,"div",25)(70,"div",26)(71,"button",27),h("click",function(){return e.saveWorkingCopyFile()}),a(72),p(73,"translate"),o()(),C(74,We,4,3,"div",28)(75,Ye,4,3,"div",28)(76,Je,4,6,"div",28),o(),C(77,Ke,2,3,"div",24),o()()),r&2&&(i(),c("formGroup",e.coForm),i(6),f("\xA0",d(8,51,"PROTECTED_B"),""),i(6),f("",d(14,53,"load.file")," "),i(2),c("id",e.helpIndex.loadFileIndx[2]),i(),c("href","#"+e.helpIndex.loadFileIndx[1],I),i(2),v(d(19,55,"instruction")),i(2),v(e.helpIndex.loadFileIndx[0]),i(2),c("rootTag",e.rootTagText)("lang",e.lang)("versionTagPath",e.versionTagPath)("startCheckSumVersion",e.startCheckSumVersionNum)("byPassCheckSum",e.byPassCheckSum)("devEnv",e.devEnv),i(),c("lang",e.lang),i(),c("ngIf",e.isStatusFinal),i(2),c("hiddenSummary",e.hideErrorSummary())("errorList",e.errorList)("headingLevel",e.headingLevel),i(5),f("",d(32,57,"company.enrolment")," "),i(2),c("id",e.helpIndex.companyEnrolmentIndx[2]),i(),c("href","#"+e.helpIndex.companyEnrolmentIndx[1],I),i(2),v(d(37,59,"instruction")),i(2),v(e.helpIndex.companyEnrolmentIndx[0]),i(2),c("showErrors",e.showErrors)("dataModel",e.companyEnrolModel)("isInternal",e.isInternal),i(4),f("",d(45,61,"address.rep")," "),i(2),c("id",e.helpIndex.addressInfoIndx[2]),i(),c("href","#"+e.helpIndex.addressInfoIndx[1],I),i(2),v(d(50,63,"instruction")),i(2),v(e.helpIndex.addressInfoIndx[0]),i(2),c("recordList",e.addressListModel)("showErrors",e.showErrors)("isInternal",e.isInternal)("earlyVersion",e.isEarlyVersion()),i(4),f("",d(58,65,"company.rep")," "),i(2),c("id",e.helpIndex.companyRepIndx[2]),i(),c("href","#"+e.helpIndex.companyRepIndx[1],I),i(2),v(d(63,67,"instruction")),i(2),v(e.helpIndex.companyRepIndx[0]),i(2),c("recordList",e.contactListModel)("showErrors",e.showErrors)("isInternal",e.isInternal),i(),c("showErrors",e.showErrors)("dataModel",e.companyEnrolModel),i(),c("ngIf",!e.isInternal),i(4),f(" ",d(73,69,"save.working.copy")," "),i(2),c("ngIf",e.isInternal),i(),c("ngIf",!e.isInternal),i(),c("ngIf",!e.isInternal),i(),c("ngIf",e.showMailToHelpText))},dependencies:[V,A,le,ae,_e,de,ce,me,pe,ve,ue,he,Fe,be,ge,ye,k,Ce,Ee,je,q,z,Oe,Ue,Ne,X,ke,H],encapsulation:2})}}return l})();export{kt as FormBaseComponent};
