import{$a as x,A as i,B as I,Ba as _e,Ca as M,D as W,Da as fe,Fa as ve,G as s,Ga as ge,H as o,Ha as T,I as a,Ia as Y,J as X,Ja as w,Ka as Ee,La as Ie,M as F,N as h,Na as L,O as y,P as _,Q as f,Qa as Ce,R as v,Ra as ye,S as p,Sa as Se,T as m,U as u,Ua as J,Va as K,W as te,X as ie,Y as l,Z as d,Za as be,_ as re,_a as Fe,ab as O,bb as A,cb as B,db as P,eb as U,fa as ne,fb as V,ga as oe,gb as N,ha as ae,hb as R,ib as k,jb as D,k as $,kb as Q,lb as j,mb as Me,n as S,o as b,qa as se,ra as pe,sa as le,ta as de,ua as ce,va as me,wa as he,x as E,y as ee,za as ue}from"./chunk-LOZUWVMD.js";function Ve(g,Z){if(g&1){let t=F();o(0,"div")(1,"section",2)(2,"header",3)(3,"h2",4),p(4),l(5,"translate"),a()(),o(6,"div",8)(7,"app-health-canada-only",29),h("errorList",function(e){S(t);let r=y();return b(r.processHealthCanadaOnlyErrors(e))}),a()()()()}if(g&2){let t=y();i(4),m(d(5,3,"panel.title.hc.only")),i(3),s("showErrors",t.showErrors)("hcuseOnlyModel",t.hcuseOnlyModel)}}function Ne(g,Z){if(g&1){let t=F();o(0,"button",26),h("click",function(){S(t);let e=y();return b(e.saveXmlFile())}),p(1),l(2,"translate"),a()}g&2&&(i(),u(" ",d(2,1,"generate.final.internal")," "))}function Re(g,Z){if(g&1){let t=F();o(0,"button",26),h("click",function(){S(t);let e=y();return b(e.saveXmlFile())}),p(1),l(2,"translate"),a()}g&2&&(i(),u(" ",d(2,1,"generate.final.external")," "))}var Ft=(()=>{class g{constructor(t,n,e,r,c,q,H,z,G){this._fb=t,this.cdr=n,this._baseService=e,this._globalService=r,this._utilsService=c,this.fileServices=q,this._versionService=H,this._checkSumService=z,this.datepipe=G,this._patentInformationErrors=[],this._drugUseErrors=[],this._noticeOfComplianceErrors=[],this._newDrugSubmissionInfoErrors=[],this._medicinalIngredientsForErrors=[],this._timingOfApplicantForErrors=[],this._attestationsForErrors=[],this._feesForErrors=[],this._certificationForErrors=[],this._applicantErrors=[],this._healthCanadaOnlyErrors=[],this.errorList=[],this.headingLevel="h2",this.rootTagText=ye,this.versionTagPath=Se,this.startCheckSumVersionNum=2,this.countryOptions=[],this.showErrors=!1}ngOnInit(){this.rtForm||(this.rtForm=this._baseService.getReactiveModel(this._fb));try{this._globalService.enrollment?this.enrollModel=this._globalService.enrollment:(this.enrollModel=this._baseService.getEmptyEnrol(),this._globalService.enrollment=this.enrollModel),this.transactionEnrollModel=this.enrollModel[this.rootTagText],this._initModels(this.transactionEnrollModel),this.lang=this._globalService.currLanguage,this.countryOptions=this._globalService.countryList,this.helpIndex=this._globalService.helpIndex,this.devEnv=this._globalService.devEnv,this.byPassCheckSum=this._globalService.byPassChecksum,this.isInternal=Ce.isInternal}catch(t){console.error(t)}}ngAfterViewInit(){document.location.href="#def-top",this.msgList.changes.subscribe(t=>{let n=[];this._updateErrorList(t),this.processErrors()}),this.msgList.notifyOnChanges()}_updateErrorList(t){}processErrors(){this.errorList=[],this.errorList=this.errorList.concat(this._applicantErrors),this.errorList=this.errorList.concat(this._patentInformationErrors),this.errorList=this.errorList.concat(this._newDrugSubmissionInfoErrors),this.errorList=this.errorList.concat(this._noticeOfComplianceErrors),this.errorList=this.errorList.concat(this._drugUseErrors),this.errorList=this.errorList.concat(this._timingOfApplicantForErrors),this.errorList=this.errorList.concat(this._medicinalIngredientsForErrors),this.errorList=this.errorList.concat(this._attestationsForErrors),this.errorList=this.errorList.concat(this._feesForErrors),this.errorList=this.errorList.concat(this._certificationForErrors),this.cdr.detectChanges()}processHealthCanadaOnlyErrors(t){this._healthCanadaOnlyErrors=t,this.processErrors()}processPatentInfoErrors(t){this._patentInformationErrors=t,this.processErrors()}processDrugUseErrors(t){this._drugUseErrors=t,this.processErrors()}processNoticeOfComplianceErrors(t){this._noticeOfComplianceErrors=t,this.processErrors()}processNewDrugSubmissionInfoErrors(t){this._newDrugSubmissionInfoErrors=t,this.processErrors()}processMedicinalIngredientsErrors(t){this._medicinalIngredientsForErrors=t,this.processErrors()}processAttestationsErrors(t){this._attestationsForErrors=t,this.processErrors()}processFeesErrors(t){this._feesForErrors=t,this.processErrors()}processTimingOfApplicantErrors(t){this._timingOfApplicantForErrors=t,this.processErrors()}processCertificationErrors(t){this._certificationForErrors=t,this.processErrors()}processApplicantErrors(t){this._applicantErrors=t,this.processErrors()}hideErrorSummary(){return this.showErrors&&this.errorList&&this.errorList.length>0}saveXmlFile(){this.showErrors=!0,this.processErrors(),this._saveXML()}saveWorkingCopyFile(){let t=this._prepareForSaving(!1),n=this._generateFileName(t.CERTIFICATE_SUPPLEMENTARY_PROTECTION.enrolment_version);this.fileServices.saveJsonToFile(t,n,null),this.saveWorkCopyTime=Date.now()}processFile(t){t.data!==null&&(this.transactionEnrollModel=t.data.CERTIFICATE_SUPPLEMENTARY_PROTECTION,this._initModels(this.transactionEnrollModel))}_initModels(t){this.cspiModel=this._baseService.getCerSuppProtect(),this.cspiModel.dateLastSaved=t.date_saved,this.cspiModel.enrollVersion=t.enrolment_version,t.application_info!=null&&(this.attestationModel=this._baseService.getAttestation(),this.drugUseModel=t.application_info.drug_use,this.patentModel=t.application_info.patent_info,this.timingOfApplicantModel=t.application_info.time_application,this.nocModel=t.application_info.noc_date,this.newDrugSubmissionModel=t.application_info.control_number,this.attestationModel.attestationAsApplicant=t.application_info.applicant_statement,this.attestationModel.attestationAsSubmission.timely_submission_statement=t.timely_submission_info.timely_submission_statement,this.attestationModel.attestationAsSubmission.marketing_application_date=t.timely_submission_info.marketing_application_date,this.attestationModel.attestationAsSubmission.marketing_country=t.timely_submission_info.marketing_country),this.hcuseOnlyModel=t.health_canada_only,this.feePaymentModel=t.advanced_payment,this.certModel=t.certification,t.advanced_payment!=null&&(this.transFeeModel=t.advanced_payment),this.applicantModel=this._baseService.getEmptyApplicant();let n=t.applicant;if(console.log(Array.isArray(t.applicant)),!Array.isArray(t.applicant)){let e=[],r=Object.entries(t.applicant);e.push(t.applicant),t.applicant=e}if(t.applicant&&t.applicant.length>0){let e=t.applicant[0];if(this.applicantModel=e,this.convertAddress(this.applicantModel.address),t.applicant[0].contact&&(this.contactModel=t.applicant[0].contact,this.convertLanguage(this.contactModel)),t.applicant[0].address&&(this.addressModel=t.applicant[0].address),t.applicant.length>1){let r=t.applicant[1];this.billingModel=r,this.convertAddress(this.billingModel.address),r.contact&&(this.contactBillingModel=r.contact,this.convertLanguage(this.contactBillingModel)),r.address&&(this.addressBillingModel=r.address)}}}preload(){}unloadNotification(t){t.returnValue=!0}_saveXML(){if(this.errorList&&this.errorList.length<1){let t=this._prepareForSaving(!0),n=this._generateFileName(t.CERTIFICATE_SUPPLEMENTARY_PROTECTION.enrolment_version),e=this._versionService.getApplicationMajorVersionWithUnderscore(this._globalService.appVersion),r=J.toUpperCase()+"_RT_"+e+".xsl";this.fileServices.saveXmlToFile(t,n,!0,r);return}document.location.href="#topErrorSummaryId"}_prepareForSaving(t){let n=this._baseService.getEmptyTransactionEnrol(),e=this.patentComponent.getFormValue();this._baseService.mapPatentFormsToOutput(n,e);let r=this.drugUseComponent.getFormValue();this._baseService.mapDrugUseFormsToOutput(n,r);let c=this.noticeOfComplianceComponent.getFormValue();this._baseService.mapNOCFormsToOutput(n,c);let q=this.newDrugSubmissionInformationComponent.getFormValue();this._baseService.mapNewDrugSubmissionInformationFormsToOutput(n,q);let H=this.feesComponent.getFormValue();this._baseService.mapFeesFormsToOutput(n,H);let z=this.medicinalIngredientsComponent.getFormValue();this._baseService.mapMedicinalIngredientsFormsToOutput(n,z);let G=this.timeOfApplicationComponent.getFormValue();if(this._baseService.mapTimingOfApplicantFormsToOutput(n,G),this.isInternal){let Pe=this.healthCanadaComponent.getFormValue();this._baseService.mapHealthCanadaOnlyFormsToOutput(n,Pe)}let Te=this.certificationComponent.getFormValue();this._baseService.mapCertificationFormsToOutput(n,Te);let we=this.applicantComponent.getFormValue(),Le=this.applicantComponent.getApplicantAddressFormValue(),xe=this.applicantComponent.getApplicantContactFormValue(),Oe=this.applicantComponent.getBillingAddressFormValue(),Ae=this.applicantComponent.getBillingContactFormValue();this._baseService.mapApplicantInfoToOutput(n,we,Le,xe,Oe,Ae);let Be=this.attestationComponent.getFormValue();this._baseService.mapAttestationFormsToOutput(n,Be,this.lang,this.countryOptions),this._baseService.mapCertificateOfSupplementaryProtectionFormsToOutput(n,this.cspiModel,this._baseService.certSuppProtectForm),n.software_version=this._globalService.appVersion,n.form_language=this._globalService.currLanguage;let C={CERTIFICATE_SUPPLEMENTARY_PROTECTION:n};return t&&(C.CERTIFICATE_SUPPLEMENTARY_PROTECTION[Y]="",C.CERTIFICATE_SUPPLEMENTARY_PROTECTION[Y]=this._checkSumService.createHash(C)),console.log("_prepareForSaving ~ output",JSON.stringify(C,null,2)),C}_generateFileName(t){return(J+K+t).replace(".",K)}onChanged(t,n){t?.target?.checked===!1&&this.rtForm.controls[n].reset()}convertAddress(t){if(t.country._id==null&&t.country.__text){let n=this._globalService.countryIdMappingList.find(e=>e.id===t.country.__text);if(n!=null&&(t.country._id=n.newid),t.country._id==="CA"||t.country._id==="US"){let e=String(t.province_lov),r=this._baseService.getEmptyIIdTextLabel();r._id=e,t.province_lov=r}else t.province_text=t.province_text}}convertLanguage(t){if(t.language_correspondance._id==null&&t.language_correspondance){let n=this._baseService.getEmptyIIdTextLabel();n._id=String(t.language_correspondance),t.language_correspondance=n}}static{this.\u0275fac=function(n){return new(n||g)(I(me),I(re),I(x),I(Fe),I(M),I(T),I(L),I(w),I(oe))}}static{this.\u0275cmp=$({type:g,selectors:[["app-form-base"]],viewQuery:function(n,e){if(n&1&&(_(A,5),_(B,5),_(P,5),_(U,5),_(V,5),_(D,5),_(N,5),_(k,5),_(Q,5),_(R,5),_(j,5),_(O,5),_(ue,5)),n&2){let r;f(r=v())&&(e.patentComponent=r.first),f(r=v())&&(e.drugUseComponent=r.first),f(r=v())&&(e.noticeOfComplianceComponent=r.first),f(r=v())&&(e.newDrugSubmissionInformationComponent=r.first),f(r=v())&&(e.medicinalIngredientsComponent=r.first),f(r=v())&&(e.timeOfApplicationComponent=r.first),f(r=v())&&(e.feesComponent=r.first),f(r=v())&&(e.applicantComponent=r.first),f(r=v())&&(e.healthCanadaComponent=r.first),f(r=v())&&(e.certificationComponent=r.first),f(r=v())&&(e.attestationComponent=r.first),f(r=v())&&(e.certSuppProtectComponent=r.first),f(r=v())&&(e.msgList=r)}},hostBindings:function(n,e){n&1&&h("beforeunload",function(c){return e.unloadNotification(c)},!1,ee)},standalone:!0,features:[te([T,M,L,w,ge,ve,x,be]),ie],decls:159,vars:148,consts:[[1,"container-fluid","wb-frmvld","wb-init","wb-frmvld-inited"],["name","transactionForm","novalidate","",3,"formGroup"],[1,"panel","panel-primary","mrgn-tp-lg"],[1,"panel-heading","clearfix"],[1,"panel-title"],[3,"id"],[1,"fn-lnk","mrgn-tp-md",3,"href"],[1,"wb-inv"],[1,"panel-body"],[3,"complete","rootTag","lang","versionTagPath","startCheckSumVersion","byPassCheckSum","devEnv"],["id","topErrorSummaryId"],["headingPreamble","errorSummary.cspfile",3,"hiddenSummary","errorList","headingLevel"],[4,"ngIf"],[3,"saveWorkCopyTime","cspiModel"],[3,"errorList","showErrors","applicantAddressModel","applicantContactModel","billingAddressModel","billingContactModel","applicantModel","billingModel"],[3,"errorList","showErrors","patentModel"],[3,"errorList","showErrors","newDrugSubmissionModel"],[3,"errorList","showErrors","nocModel"],[3,"errorList","showErrors","drugUseModel"],[3,"errorList","showErrors","timingOfApplicantModel"],[3,"errorList","showErrors","transactionEnrollModel"],[3,"errorList","showErrors","attestationModel"],[3,"errorList","showErrors","feePaymentModel"],[3,"errorList","showErrors","certModel"],[1,"row","btn-group-sm"],[1,"form-group","col-md-4"],["type","button",1,"btn","btn-primary","btn-lg","active",3,"click"],["type","button","class","btn btn-primary btn-lg active",3,"click",4,"ngIf"],[1,"mrgn-tp-lg"],[3,"errorList","showErrors","hcuseOnlyModel"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"form",1)(2,"div")(3,"section",2)(4,"header",3)(5,"h2",4),p(6),l(7,"translate"),o(8,"sup",5)(9,"a",6)(10,"span",7),p(11),l(12,"translate"),a(),p(13),a()()()(),o(14,"div",8)(15,"lib-file-reader",9),h("complete",function(c){return e.processFile(c)}),a()()()(),o(16,"div",10),X(17,"lib-error-summary",11),a(),W(18,Ve,8,5,"div",12),o(19,"div")(20,"section",2)(21,"header",3)(22,"h2",4),p(23),l(24,"translate"),o(25,"sup",5)(26,"a",6)(27,"span",7),p(28),l(29,"translate"),a(),p(30),a()()()(),o(31,"div",8),X(32,"app-cert-supp-protect",13),a(),o(33,"header",8)(34,"h3",4),p(35),l(36,"translate"),o(37,"sup",5)(38,"a",6)(39,"span",7),p(40),l(41,"translate"),a(),p(42),a()()()(),o(43,"div",8)(44,"app-applicant",14),h("errorList",function(c){return e.processApplicantErrors(c)}),a()(),o(45,"header",8)(46,"h3",4),p(47),l(48,"translate"),o(49,"sup",5)(50,"a",6)(51,"span",7),p(52),l(53,"translate"),a(),p(54),a()()()(),o(55,"div",8)(56,"app-patent",15),h("errorList",function(c){return e.processPatentInfoErrors(c)}),a()(),o(57,"header",8)(58,"h3",4),p(59),l(60,"translate"),o(61,"sup",5)(62,"a",6)(63,"span",7),p(64),l(65,"translate"),a(),p(66),a()()()(),o(67,"div",8)(68,"app-new-drug-submission-information",16),h("errorList",function(c){return e.processNewDrugSubmissionInfoErrors(c)}),a()(),o(69,"header",8)(70,"h3",4),p(71),l(72,"translate"),o(73,"sup",5)(74,"a",6)(75,"span",7),p(76),l(77,"translate"),a(),p(78),a()()()(),o(79,"div",8)(80,"app-notice-of-compliance",17),h("errorList",function(c){return e.processNoticeOfComplianceErrors(c)}),a()(),o(81,"header",8)(82,"h3",4),p(83),l(84,"translate"),o(85,"sup",5)(86,"a",6)(87,"span",7),p(88),l(89,"translate"),a(),p(90),a()()()(),o(91,"div",8)(92,"app-drug-use",18),h("errorList",function(c){return e.processDrugUseErrors(c)}),a()(),o(93,"header",8)(94,"h3",4),p(95),l(96,"translate"),a()(),o(97,"div",8)(98,"app-time-of-application",19),h("errorList",function(c){return e.processTimingOfApplicantErrors(c)}),a()(),o(99,"header",8)(100,"h3",4),p(101),l(102,"translate"),o(103,"sup",5)(104,"a",6)(105,"span",7),p(106),l(107,"translate"),a(),p(108),a()()()(),o(109,"div",8)(110,"app-medicinal-ingredients",20),h("errorList",function(c){return e.processMedicinalIngredientsErrors(c)}),a()(),o(111,"header",8)(112,"h3",4),p(113),l(114,"translate"),o(115,"sup",5)(116,"a",6)(117,"span",7),p(118),l(119,"translate"),a(),p(120),a()()()(),o(121,"div",8)(122,"app-attestation",21),h("errorList",function(c){return e.processAttestationsErrors(c)}),a()(),o(123,"header",8)(124,"h3",4),p(125),l(126,"translate"),o(127,"sup",5)(128,"a",6)(129,"span",7),p(130),l(131,"translate"),a(),p(132),a()()()(),o(133,"div",8)(134,"app-fees",22),h("errorList",function(c){return e.processFeesErrors(c)}),a()(),o(135,"header",8)(136,"h3",4),p(137),l(138,"translate"),o(139,"sup",5)(140,"a",6)(141,"span",7),p(142),l(143,"translate"),a(),p(144),a()()()(),o(145,"div",8)(146,"app-certification",23),h("errorList",function(c){return e.processCertificationErrors(c)}),a()()()(),o(147,"div",24)(148,"div",25)(149,"button",26),h("click",function(){return e.saveWorkingCopyFile()}),p(150),l(151,"translate"),a()(),o(152,"div",25),W(153,Ne,3,3,"button",27)(154,Re,3,3,"button",27),a()(),o(155,"div",28)(156,"span"),p(157),l(158,"translate"),a()()()()),n&2&&(i(),s("formGroup",e.rtForm),i(5),u("",d(7,98,"load.file")," "),i(2),s("id",e.helpIndex.loadFileIndx[2]),i(),s("href","#"+e.helpIndex.loadFileIndx[1],E),i(2),m(d(12,100,"instruction")),i(2),m(e.helpIndex.loadFileIndx[0]),i(2),s("rootTag",e.rootTagText)("lang",e.lang)("versionTagPath",e.versionTagPath)("startCheckSumVersion",e.startCheckSumVersionNum)("byPassCheckSum",e.byPassCheckSum)("devEnv",e.devEnv),i(2),s("hiddenSummary",e.hideErrorSummary())("errorList",e.errorList)("headingLevel",e.headingLevel),i(),s("ngIf",e.isInternal),i(5),u("",d(24,102,"panel.title.csp")," "),i(2),s("id",e.helpIndex.dateLastIndx[2]),i(),s("href","#"+e.helpIndex.dateLastIndx[1],E),i(2),m(d(29,104,"instruction")),i(2),m(e.helpIndex.dateLastIndx[0]),i(2),s("saveWorkCopyTime",e.saveWorkCopyTime)("cspiModel",e.cspiModel),i(3),u("",d(36,106,"panel.title.applicant")," "),i(2),s("id",e.helpIndex.appContactIndx[2]),i(),s("href","#"+e.helpIndex.appContactIndx[1],E),i(2),m(d(41,108,"instruction")),i(2),m(e.helpIndex.appContactIndx[0]),i(2),s("showErrors",e.showErrors)("applicantAddressModel",e.addressModel)("applicantContactModel",e.contactModel)("billingAddressModel",e.addressBillingModel)("billingContactModel",e.contactBillingModel)("applicantModel",e.applicantModel)("billingModel",e.billingModel),i(3),u("",d(48,110,"panel.title.patent")," "),i(2),s("id",e.helpIndex.patentInfoIndx[2]),i(),s("href","#"+e.helpIndex.patentInfoIndx[1],E),i(2),m(d(53,112,"instruction")),i(2),m(e.helpIndex.patentInfoIndx[0]),i(2),s("showErrors",e.showErrors)("patentModel",e.patentModel),i(3),u("",d(60,114,"panel.title.new.drug.submission.info")," "),i(2),s("id",e.helpIndex.newDrugIndx[2]),i(),s("href","#"+e.helpIndex.newDrugIndx[1],E),i(2),m(d(65,116,"instruction")),i(2),m(e.helpIndex.newDrugIndx[0]),i(2),s("showErrors",e.showErrors)("newDrugSubmissionModel",e.newDrugSubmissionModel),i(3),u("",d(72,118,"panel.title.noticeofcompliance")," "),i(2),s("id",e.helpIndex.nocDateIndx[2]),i(),s("href","#"+e.helpIndex.nocDateIndx[1],E),i(2),m(d(77,120,"instruction")),i(2),m(e.helpIndex.nocDateIndx[0]),i(2),s("showErrors",e.showErrors)("nocModel",e.nocModel),i(3),u("",d(84,122,"panel.title.druguse")," "),i(2),s("id",e.helpIndex.drugUseIndx[2]),i(),s("href","#"+e.helpIndex.drugUseIndx[1],E),i(2),m(d(89,124,"instruction")),i(2),m(e.helpIndex.drugUseIndx[0]),i(2),s("showErrors",e.showErrors)("drugUseModel",e.drugUseModel),i(3),m(d(96,126,"panel.title.timing.of.application")),i(3),s("showErrors",e.showErrors)("timingOfApplicantModel",e.timingOfApplicantModel),i(3),u("",d(102,128,"panel.title.medicinal.ingredients")," "),i(2),s("id",e.helpIndex.medicIngrIndx[2]),i(),s("href","#"+e.helpIndex.medicIngrIndx[1],E),i(2),m(d(107,130,"instruction")),i(2),m(e.helpIndex.medicIngrIndx[0]),i(2),s("showErrors",e.showErrors)("transactionEnrollModel",e.transactionEnrollModel),i(3),u("",d(114,132,"panel.title.attestations")," "),i(2),s("id",e.helpIndex.attestationIndx[2]),i(),s("href","#"+e.helpIndex.attestationIndx[1],E),i(2),m(d(119,134,"instruction")),i(2),m(e.helpIndex.attestationIndx[0]),i(2),s("showErrors",e.showErrors)("attestationModel",e.attestationModel),i(3),u("",d(126,136,"panel.title.fees")," "),i(2),s("id",e.helpIndex.feePayIndx[2]),i(),s("href","#"+e.helpIndex.feePayIndx[1],E),i(2),m(d(131,138,"instruction")),i(2),m(e.helpIndex.feePayIndx[0]),i(2),s("showErrors",e.showErrors)("feePaymentModel",e.feePaymentModel),i(3),u("",d(138,140,"panel.title.certification")," "),i(2),s("id",e.helpIndex.certificationIndx[2]),i(),s("href","#"+e.helpIndex.certificationIndx[1],E),i(2),m(d(143,142,"instruction")),i(2),m(e.helpIndex.certificationIndx[0]),i(2),s("showErrors",e.showErrors)("certModel",e.certModel),i(4),u(" ",d(151,144,"save.working.copy")," "),i(3),s("ngIf",e.isInternal),i(),s("ngIf",!e.isInternal),i(3),m(d(158,146,"public.disc")))},dependencies:[ae,ne,pe,se,he,de,le,ce,Ie,Ee,fe,_e,Me,Q,O,A,B,P,U,V,D,k,R,N,j],encapsulation:2})}}return g})();export{Ft as FormBaseComponent};
